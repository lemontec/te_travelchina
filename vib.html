<html>
    <head>
        <script src="js/jquery-1.11.1.min.js"></script>
        <script>
// public enable
// the following code is copied from: https://www.cnblogs.com/catEatBird/p/7123441.html
function toShake(callBack) {
    var RANGE = 60;//当用户摇晃的幅度超过这个值，我们认定用户在摇一摇
    var isShake = false;//是否进行了摇一摇
    var lastX,lastY,lastZ;
    var lastTime = Date.now();
    window.addEventListener('devicemotion', function(e) {
        var nowTime = Date.now();
        //拉开执行的间隔，让iso和安卓的执行频率接近一致
        if(nowTime - lastTime < 100){
            return;
        }
        lastTime = nowTime;
        var motion = e.accelerationIncludingGravity;
        var x = motion.x;
        var y = motion.y;
        var z = motion.z;
        if(typeof lastX == "undefined"){//第一次进来还没有上一次的值
            lastX = x;
            lastY = y;
            lastZ = z;
            return;
        }
        var nowRange = Math.abs(x - lastX) + Math.abs(y - lastY) + Math.abs(z - lastZ);
        if(nowRange > RANGE){
            isShake = true;
        } 
        //当用户进行了剧烈的摇动，我们就认定用户进行了摇一摇，然后摇晃幅度慢下来之后，执行摇一摇函数
        if(isShake&&nowRange < 20){
            callBack&&callBack();
            isShake = false;
        }
        lastX = x;
        lastY = y;
        lastZ = z;
    });
}

toShake(function(){
    // alert("shake shake.");
    playSound();
});

        var vibrate = function() {
            navigator.vibrate = navigator.vibrate
                || navigator.webkitVibrate
                || navigator.mozVibrate
                || navigator.msVibrate;

            if (navigator.vibrate) {
                // 支持
                console.log("支持设备震动！");
                navigator.vibrate([500, 300, 400, 300]);
            } else {
                alert("不支持震动。");
            }
        }

function playSound()
{
    var borswer = window.navigator.userAgent.toLowerCase();
    if ( borswer.indexOf( "ie" ) >= 0 )
    {
        //IE内核浏览器
        var strEmbed = '<embed name="embedPlay" src="10215.wav" autostart="true" hidden="true" loop="false"></embed>';
        if ( $( "body" ).find( "embed" ).length <= 0 )
            $( "body" ).append( strEmbed );
        var embed = document.embedPlay;

        //浏览器不支持 audion，则使用 embed 播放
        embed.volume = 100;
        //embed.play();这个不需要
    } else
    {
        //非IE内核浏览器
        var strAudio = "<audio id='audioPlay' src='10215.wav' hidden='true'>";
        if ( $( "body" ).find( "audio" ).length <= 0 )
            $( "body" ).append( strAudio );
        var audio = document.getElementById( "audioPlay" );

        //浏览器支持 audion
        audio.play();
    }
}
        </script>
    </head>
    <body>
        <button onclick="vibrate()">vib</button>
        <br />
        <button onclick="playSound()">sound</button>
    </body>
</html>

